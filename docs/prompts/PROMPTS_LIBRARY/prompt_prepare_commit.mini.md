# חובה  קובץ זה הוא חלק משיטת Docs as System mini  
# חובה  אין לערוך קובץ זה בתוך פרויקט פעיל  
# חובה  שינוי בקובץ זה יתבצע רק בעדכון רשמי של השיטה

# הכנת קומיט

מטרה  
להכין קומיט מדויק  
מבוקר  
ותואם לחלוטין את המשימה שבוצעה  
כולל שימוש מלא במדיניות הסוכן  
בקובצי המסמכים  
ובסקריפט הביצוע הרשמי STAGE_AND_COMMIT.sh

קבצים רלוונטיים  
docs/logs/IMPLEMENTATION_LOG.mini.md  
docs/project/IMPLEMENTATION_PLAN.mini.md  
docs/agent/AGENT_CONFIG.mini.yaml  
docs/automation/STAGE_AND_COMMIT.sh  

## הוראות  

זהה את השלב והמשימה הנוכחיים מתוך  
docs/project/IMPLEMENTATION_PLAN.mini.md  

בדוק אילו קבצים שונו בעקבות המשימה  
ודא שכל הקבצים שייכים למשימה  
בדוק שאין שינוי שאינו חלק ממנה  
בדוק שכל שינוי מופיע בלוג  
בדוק שכל הבדיקות עברו בהצלחה  
ודא שהתוצאה תואמת את המסמכים  

## ניסוח הודעת קומיט  

קרא את הרשומה האחרונה בלוג  
docs/logs/IMPLEMENTATION_LOG.mini.md  

זהה מתוך הרשומה  
● שם השלב  
● שם המשימה  
● תקציר קצר של מה בוצע  

בנה הודעת קומיט קצרה וברורה  
המבוססת רק על המידע שבלוג  
אל תוסיף מידע שאינו מופיע בלוג  
אל תזכיר קבצים שאינם חלק מהרשומה  

## הגדרת רשימת הקבצים המאושרת  

הכן רשימה מדויקת של כל הקבצים ששונו במשימה  
השתמש רק בקבצים אלו בביצוע הסטייג  
אל תכלול קבצים שאינם חלק מהמשימה  
אל תכלול קבצים שזוהו כחריגה  

## בדיקות לפני ביצוע  

קרא את docs/agent/AGENT_CONFIG.mini.yaml  

ודא שהערך git.allowAgentCommit הוא true  
בדוק שהענף הנוכחי אינו חלק מ git.protectedBranches  
בדוק שכל הנתיבים של הקבצים תואמים ל git.allowedPaths  

אם אחת מהבדיקות נכשלת  
עצור  
סכם את המצב  
ובקש הנחיה מאדם  

## שכבת ביצוע הקומיט  

לאחר שכל תנאי ההמשך התקיימו  
יש לבצע קומיט רק באמצעות הסקריפט הרשמי

הכן את משתני הסביבה  
MESSAGE  
COMMIT_SCOPE  

הנחיות  
● MESSAGE מכיל את הודעת הקומיט שבנית  
● COMMIT_SCOPE משקף את תחום השינוי (למשל docs או src או mixed)  
● רשימת הקבצים עוברת כארגומנטים לסקריפט בלבד  

ביצוע הפעולה  

```bash
MESSAGE="<commit-message>" \
COMMIT_SCOPE="<scope>" \
./docs/automation/STAGE_AND_COMMIT.sh <file1> <file2> <file3>
```

## כללים מחייבים  
אין להריץ פקודת git ישירות  
אין לבצע git add באופן עצמאי  
אין לבצע git commit ללא הסקריפט  
אין לעקוף את allowedPaths  
אין לעקוף את protectedBranches  

## תנאי המשך  
הסקריפט הסתיים בהצלחה  
כל הקבצים עברו סטייג תקין  
הקומיט נוצר עם הודעה תואמת  
אין שגיאות מהסקריפט  
הכל מתועד בלוג של המחזור  

## פלט מצופה  
קומיט שנוצר באמצעות הסקריפט הרשמי  
תואם לחלוטין את המשימה  
תואם את הלוג  
תואם את המסמכים  
מוכן לדחיפה או לפתיחת בקשת משיכה  


